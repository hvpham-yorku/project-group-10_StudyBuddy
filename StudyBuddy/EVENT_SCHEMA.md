# Event JSON Schema Reference

This document defines the exact JSON structure for events used by both frontend and backend.

## Event Object Structure

```json
{
  "eventId": "abc123xyz",
  "hostId": "user_123",
  "title": "EECS 2311 Study Session",
  "course": "EECS 2311",
  "location": "Scott Library Room 101",
  "description": "Working on Sprint 1 together. Bring your laptops!",
  "startTime": "2025-02-15T14:00:00",
  "endTime": "2025-02-15T16:00:00",
  "maxCapacity": 6,
  "participantIds": ["user_456", "user_789"]
}
```

## Field Descriptions

| Field | Type | Description | Required | Generated By |
|-------|------|-------------|----------|--------------|
| `eventId` | string | Unique identifier for the event | No (on create) | Firestore (auto) |
| `hostId` | string | User ID of the person who created the event | Yes | Frontend |
| `title` | string | Name/title of the study session | Yes | Frontend form |
| `course` | string | Course code (e.g., "EECS 2311") | Yes | Frontend form |
| `location` | string | Where the event takes place | Yes | Frontend form |
| `description` | string | Additional details about the event | Yes | Frontend form |
| `startTime` | string (ISO 8601) | When the event starts | Yes | Frontend form |
| `endTime` | string (ISO 8601) | When the event ends | Yes | Frontend form |
| `maxCapacity` | integer | Maximum number of participants | Yes | Frontend form |
| `participantIds` | array of strings | List of user IDs who joined | No | Backend (defaults to []) |

## Date/Time Format

Use **ISO 8601** format: `YYYY-MM-DDTHH:mm:ss`

Examples:
- `2025-02-15T14:00:00` = February 15, 2025 at 2:00 PM
- `2025-02-15T16:30:00` = February 15, 2025 at 4:30 PM

JavaScript example:
```javascript
const startTime = new Date("2025-02-15T14:00:00").toISOString().slice(0, 19);
```

## Example: Creating an Event (Frontend)

```javascript
const eventData = {
  hostId: "vaughn_test_1",  // Hardcoded for MVP
  title: document.getElementById("title").value,
  course: document.getElementById("course").value,
  location: document.getElementById("location").value,
  description: document.getElementById("description").value,
  startTime: document.getElementById("startTime").value,
  endTime: document.getElementById("endTime").value,
  maxCapacity: parseInt(document.getElementById("maxCapacity").value),
  participantIds: []  // Empty array initially
};

const response = await fetch("http://localhost:8080/api/events", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify(eventData)
});

const createdEvent = await response.json();
console.log("Created event:", createdEvent);
```

## Capacity Display Logic

To show how full an event is:

```javascript
const current = event.participantIds.length;
const max = event.maxCapacity;
const capacityText = `${current}/${max}`;

// Bonus: Show if event is full
const isFull = current >= max;
```

## Validation Rules

### Frontend (before sending to backend):
- `title`: Not empty, max 100 characters
- `course`: Not empty, max 50 characters
- `location`: Not empty, max 100 characters
- `description`: Max 500 characters
- `startTime`: Must be in the future
- `endTime`: Must be after `startTime`
- `maxCapacity`: Must be > 0, reasonable limit (e.g., <= 50)

### Backend (currently minimal, can add more):
- Firestore will generate `eventId`
- `participantIds` defaults to empty array if not provided
- All other fields are accepted as-is (add validation in future sprints)

## API Response Examples

### Success (201 Created)
```json
{
  "eventId": "xyz789abc",
  "hostId": "vaughn_test_1",
  "title": "EECS 2311 Study Session",
  "course": "EECS 2311",
  "location": "Scott Library Room 101",
  "description": "Working on Sprint 1",
  "startTime": "2025-02-15T14:00:00",
  "endTime": "2025-02-15T16:00:00",
  "maxCapacity": 6,
  "participantIds": []
}
```

### Error (500 Internal Server Error)
```json
{
  "timestamp": "2025-02-12T10:30:00.000+00:00",
  "status": 500,
  "error": "Internal Server Error",
  "path": "/api/events"
}
```

## Notes for Future Development

### Features to Add:
1. **Join Event** - Add userId to participantIds array
2. **Leave Event** - Remove userId from participantIds
3. **Edit Event** - PUT endpoint (only host can edit)
4. **Filter Events** - By course, date, location
5. **Search Events** - Text search in title/description

### Security Enhancements:
1. Replace hardcoded `hostId` with Firebase Auth token
2. Add authentication middleware
3. Validate user owns the hostId they're claiming
4. Rate limiting on API calls

### Data Enhancements:
1. Add `createdAt` timestamp
2. Add `updatedAt` timestamp
3. Add event status (active, cancelled, completed)
4. Add tags/categories
5. Add host details (name, profile picture)
